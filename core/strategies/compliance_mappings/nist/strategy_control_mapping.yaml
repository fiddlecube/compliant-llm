# NIST Control Mappings for LLM Attack Strategies
# This file maps each attack strategy to specific NIST controls

strategy_mappings:
  # Insecure Output Handling (LLM07)
  insecure_output_handling:
    description: "Strategy for testing LLM security against insecure output handling vulnerabilities"
    
    nist_sp_800_53:
      - control_id: "SI-10"
        name: "Information Input Validation"
        description: "Tests if the LLM properly validates outputs that may be used as input in downstream applications"
        family: "System and Information Integrity"
      - control_id: "SI-15"
        name: "Information Output Filtering"
        description: "Tests if the LLM filters outputs to prevent disclosure of harmful code or unauthorized data"
        family: "System and Information Integrity"
      - control_id: "SI-7"
        name: "Software, Firmware, and Information Integrity"
        description: "Tests if the LLM preserves the integrity of output information"
        family: "System and Information Integrity"
      - control_id: "SC-8"
        name: "Transmission Confidentiality and Integrity"
        description: "Tests if LLM output maintains integrity during processing and transmission"
        family: "System and Communications Protection"
      - control_id: "SC-18"
        name: "Mobile Code"
        description: "Tests if LLM prevents generation of potentially harmful mobile code"
        family: "System and Communications Protection"

    nist_ai_rmf:
      - control_id: "Map 1.2"
        category: "Context"
        description: "Tests if system documentation accurately reflects output handling risks"
      - control_id: "Measure 3.1"
        category: "Performance"
        description: "Tests if the model appropriately handles potentially harmful output generation requests"
      - control_id: "Manage 2.3"
        category: "Security"
        description: "Tests implementation of output security controls for protection against harmful content"
      - control_id: "Govern 3.2"
        category: "Accountability"
        description: "Tests governance mechanisms for output validation and security"
    
    attack_categories:
      - name: "XSS Generation"
        severity: "High"
        fips_impact: "Moderate"
        control_objective: "Prevent LLM from generating XSS payloads in HTML context"
      - name: "SQL Injection"
        severity: "Critical"
        fips_impact: "High"
        control_objective: "Prevent LLM from generating SQL injection patterns"
      - name: "Command Injection"
        severity: "Critical"
        fips_impact: "High"
        control_objective: "Prevent LLM from outputting shell command injections"
      - name: "Unsafe Template Content"
        severity: "High"
        fips_impact: "Moderate"
        control_objective: "Prevent template injection in rendered output"
      - name: "Insecure Deserialization"
        severity: "High"
        fips_impact: "Moderate"
        control_objective: "Prevent unsafe deserialization patterns in code output"

  # Excessive Agency (LLM01)
  excessive_agency:
    description: "Strategy for testing LLM security against excessive agency vulnerabilities"
    
    nist_sp_800_53:
      - control_id: "AC-3"
        name: "Access Enforcement"
        description: "Tests if the LLM enforces approved authorizations for access to functions"
        family: "Access Control"
      - control_id: "AC-6"
        name: "Least Privilege"
        description: "Tests if the LLM operates with least privilege and does not exceed its authorized boundaries"
        family: "Access Control"
      - control_id: "SI-4"
        name: "System Monitoring"
        description: "Tests if the LLM has appropriate monitoring to detect unauthorized actions"
        family: "System and Information Integrity"
      - control_id: "CM-7"
        name: "Least Functionality"
        description: "Tests if the LLM restricts its functionality to only authorized capabilities"
        family: "Configuration Management"

    nist_ai_rmf:
      - control_id: "Govern 1.4"
        category: "Accountability"
        description: "Tests if the LLM follows defined roles and responsibilities"
      - control_id: "Map 2.1"
        category: "Risks"
        description: "Tests if risks of unauthorized actions are identified and mitigated"
      - control_id: "Manage 1.3"
        category: "Explainability"
        description: "Tests if the LLM's scope of operation is well-defined and explained"
      - control_id: "Govern 2.1"
        category: "Policies"
        description: "Tests if policies around LLM agency are enforced"
    
    attack_categories:
      - name: "Unauthorized Tool Use"
        severity: "High"
        fips_impact: "Moderate"
        control_objective: "Prevent LLM from using tools without explicit authorization"
      - name: "Scope/Role Escalation"
        severity: "High"
        fips_impact: "Moderate"
        control_objective: "Prevent LLM from operating outside its designated role or scope"
      - name: "Command Execution"
        severity: "Critical"
        fips_impact: "High"
        control_objective: "Prevent LLM from attempting to execute unauthorized commands"
      - name: "User Manipulation"
        severity: "Medium"
        fips_impact: "Moderate"
        control_objective: "Prevent LLM from manipulating users into granting expanded privileges"

  # Jailbreak Strategy
  jailbreak:
    description: "Strategy for testing LLM security against jailbreak vulnerabilities"
    
    nist_sp_800_53:
      - control_id: "AC-3"
        name: "Access Enforcement"
        description: "Tests if access control mechanisms can be circumvented"
        family: "Access Control"
      - control_id: "SI-3"
        name: "Malicious Code Protection" 
        description: "Tests if content filters prevent malicious inputs or instructions"
        family: "System and Information Integrity"
      - control_id: "SC-7"
        name: "Boundary Protection"
        description: "Tests if system boundaries between allowed and prohibited content are enforced"
        family: "System and Communications Protection"
      - control_id: "AC-25"
        name: "Reference Monitor"
        description: "Tests if security policy enforcement mechanisms can be bypassed"
        family: "Access Control"

    nist_ai_rmf:
      - control_id: "Map 1.3"
        category: "Context"
        description: "Tests if LLM understands and enforces ethical boundaries in all contexts"
      - control_id: "Measure 3.2"
        category: "Performance"
        description: "Tests LLM robustness against specially crafted inputs designed to bypass controls"
      - control_id: "Manage 2.1"
        category: "Security"
        description: "Tests security controls for resistance to control bypassing techniques"
      - control_id: "Govern 2.2"
        category: "Accountability"
        description: "Tests compliance with governance directives under adversarial conditions"
    
    attack_categories:
      - name: "Character Formatting Tricks"
        severity: "Medium"
        fips_impact: "Low"
        control_objective: "Prevent bypassing content filters with Unicode or formatting tricks"
      - name: "Context Corruption"
        severity: "High"
        fips_impact: "Moderate"
        control_objective: "Prevent misleading the LLM about its operating context"
      - name: "Token Manipulation"
        severity: "Medium"
        fips_impact: "Low"
        control_objective: "Prevent manipulation of token boundaries to bypass filters"
      - name: "Semantic Confusion"
        severity: "High"
        fips_impact: "Moderate"
        control_objective: "Prevent semantic attacks that confuse the LLM into bypassing restrictions"

  # Prompt Injection
  prompt_injection:
    description: "Strategy for testing LLM security against prompt injection vulnerabilities"
    
    nist_sp_800_53:
      - control_id: "SI-10"
        name: "Information Input Validation"
        description: "Tests if user inputs are properly validated to prevent injection attacks"
        family: "System and Information Integrity"
      - control_id: "AC-4"
        name: "Information Flow Enforcement"
        description: "Tests if information flow between prompts and responses is properly controlled"
        family: "Access Control"
      - control_id: "SI-7"
        name: "Software, Firmware, and Information Integrity"
        description: "Tests if prompt integrity is maintained throughout processing"
        family: "System and Information Integrity"
      - control_id: "SC-18"
        name: "Mobile Code"
        description: "Tests if the system prevents execution of injected prompt code"
        family: "System and Communications Protection"

    nist_ai_rmf:
      - control_id: "Map 2.2"
        category: "Risks"
        description: "Tests if prompt injection risks are identified and mitigated"
      - control_id: "Measure 2.1"
        category: "Testing"
        description: "Tests LLM resilience against various injection techniques"
      - control_id: "Manage 2.4"
        category: "Security"
        description: "Tests implementation of security controls specific to prompt injection"
      - control_id: "Govern 1.3"
        category: "Accountability"
        description: "Tests governance mechanisms for preventing prompt overrides"
    
    attack_categories:
      - name: "Direct Prompt Injection"
        severity: "High"
        fips_impact: "Moderate"
        control_objective: "Prevent direct injection of malicious prompts"
      - name: "Context Switching"
        severity: "High"
        fips_impact: "Moderate"
        control_objective: "Prevent switching context to execute arbitrary instructions"
      - name: "System Prompt Extraction"
        severity: "Critical"
        fips_impact: "High"
        control_objective: "Prevent extraction of system prompts or instruction sets"
      - name: "Indirect Prompt Injection"
        severity: "High"
        fips_impact: "Moderate"
        control_objective: "Prevent injection through indirectly interpreted content"

  # Additional strategies would continue with the same pattern
